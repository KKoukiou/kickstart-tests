#version=DEVEL
#test name: firewall-disable
#
# Test that firewall can be properly disabled.
%ksappend repos/default.ks

%ksappend common/common_no_payload.ks
%ksappend payload/default_packages.ks

# disable firewall
firewall --disable

%post
# The firewall --disable kickstart command gets translated into firewall-offline-cmd --disable,
# which simply disables the firewalld systemd unit. So by checking if the unit is disabled,
# we can check if the kickstart command works correctly.
systemctl is-enabled firewalld
if [[ $? -eq 0 ]]; then
    echo "*** firewalld.service should be disabled" >> /root/RESULT
fi

%ksappend validation/success_if_result_empty.ks
%end
